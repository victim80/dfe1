<div class="eg-content-editor" data-type="imageEditorOneColumn"><div class="column">
  <div class="row" data-content-type="ImageEditor">
  <div class="cropped-image" style="position:relative;overflow: hidden;padding-top: 20.6640625%">
    <img style="position: absolute; top: 50%;left: 50%;transform: translate(-50%, -50%);max-width: 100%; max-height: 100%;" src="https://files-storage.easygenerator.com/image/708ec4c4-7fe1-4f7d-ab9f-246c63665f7e.png" alt="" data-src="https://files-storage.easygenerator.com/image/8526d047-ab47-4c7b-a3c0-66bf48691fa2.png" data-init='{"w":880,"h":181.84375000000003,"y":0,"x":-27.509777777777742,"defaultScale":1.695746031746032,"scale":0.847873015873016}' />
  </div>
</div>
  <div class="row" data-content-type="TextEditor"><p style="text-align:center;height:normal;">Figure 7.39: Checking Metadata associated with a file on a Mac system using stat command</p><p><strong>Application Bundles</strong></p><p style="text-align:justify;height:normal;">These are special directories that store application data and are hidden from the user. Investigators should analyze these bundles to identify malware<strong>&nbsp;</strong>or other suspicious data. Evaluate the executable codes to check if something is wrong with the application.</p><p><strong>Finder</strong></p><p style="text-align:justify;height:normal;">This is the default Mac application that helps find specific files and folders and also helps sort them in the required order.</p><p><strong>User Account</strong></p><p style="text-align:justify;height:normal;">User account data stores information related to all user accounts such as user IDs, and <strong>passwordpolicyoption</strong>. It also helps in identifying the guest and administrator users. The user account data is stored in the user library folder -<strong>&nbsp;/Users/username/Library</strong>. Collect information such as modification, access, and creation times for each account</p><p><strong>File System</strong></p><p style="text-align:justify;height:normal;">MacOS uses Apple File System<strong>&nbsp;</strong>(APFS) that comprises of two layers, the container layer and the file system layer. The container layer contains data such volume metadata, encryption state, and snapshots of the volume. The file system layer stores information such as file metadata, file content, and directory structures</p><p><strong>Basic Security Module (BSM)</strong></p><p style="text-align:justify;height:normal;">BSM saves file information and related events using a token, which has a binary structure. The token represents specific data, such as program arguments, return value, text data, socket, execution, and action in a file. Data stored in BSM helps determine the file type, creator, and usage data.</p><p><strong>Spotlight</strong></p><p style="text-align:justify;height:normal;">Spotlight is an integrated search feature of the MAC OS, which indexes the files by their types and thus makes the search easier. This technology is particularly useful for investigators to trace suspicious files and applications. Use a spotlight to search for specific keywords within files that represent malicious activity.</p><p><strong>Home Directory</strong></p><p style="text-align:justify;height:normal;">In macOS, the Home folder stores all the files, documents, applications, library folders, etc., pertaining to a particular user. It stores the authentication data, such as logon attempts (both success and failure) of all users, along with application and installation folders.</p><p style="text-align:justify;height:normal;">The OS creates a separate home directory for each user of the system with their username. Therefore, investigators can easily analyze the Home directory and retrieve crucial data such as passwords, log files, library folders, logon attempts, and other forensically significant information. Home folder examination can also help in determining all the attempts made to bypass the security measures along with the relevant timestamps. Other files include desktop, documents, library, and magazines.</p><p><strong>Time Machine</strong></p><p style="text-align:justify;height:normal;">Time machine is a backup tool that stores the contents of the hard disk. This includes a <strong>BackupAlias</strong> file containing the binary information related to the hard disk used to store the backups.</p><p><strong>Kexts</strong></p><p style="text-align:justify;height:normal;">MacOS can incorporate additional capabilities<strong>&nbsp;</strong>by loading kernel extensions. Analyze the system for kernel extensions.</p><p><strong>Apple Mail</strong></p><p style="text-align:justify;height:normal;">MacOS has a default standalone email client called Apple Mail which provides multiple POP3 and IMAP account support and advanced filtering. &nbsp;It stores all the email messages on the host computer in the <strong>/Users//Library/Mail</strong> directory. It Saves email in <strong>emlx</strong> format, where each email is stored as a file in ASCII format. These email messages can act as a crucial source of forensic evidence. Use email extractors such as Email Extractor 7 and Data Extractor to analyze email data.</p><p><strong>Safari</strong></p><p style="text-align:justify;height:normal;">Safari is the default web browser for MacOS. It stores information on the browsing history, download history, etc. as plist files in the Library folder. Data such as browsing history, download history, and bookmarks can be used as evidence and are stored as <strong>History.plist</strong>, <strong>Downloads.plist</strong>, and <strong>Bookmarks.plist</strong> respectively in the <strong>/Users//Library/Safari</strong> location.</p><p><strong>iChat</strong></p><p style="text-align:justify;height:normal;">MacOS comes with default Instant Messaging application named iChat. It does not automatically store previous conversations; but users can choose to save them manually. Check for any saved chats in the default location: <strong>/Users/&lt;username&gt;/Documents/iChats</strong>. Individual applications are stored as <strong>&lt;username&gt; on &lt;date&gt; at &lt;time&gt;.ichat</strong>.</p><p><strong>Command Line Inputs</strong></p><p>&nbsp;MacOS records commands in the bash shell and stores them in the file <strong>.bash_history</strong>. Use the &nbsp;<strong>$tail .bash_history</strong> command to view the most recent commands that have been run on the suspect machine.</p></div>
</div></div>