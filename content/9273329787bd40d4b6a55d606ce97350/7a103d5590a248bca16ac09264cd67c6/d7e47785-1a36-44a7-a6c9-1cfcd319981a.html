<div class="eg-content-editor" data-type="imageEditorOneColumn"><div class="column">
  <div class="cropped-image" style="position:relative;overflow: hidden;padding-top: 49.54545454545455%">
    <img style="position: absolute; top: 50%;left: 50%;transform: translate(-50%, -50%);max-width: 100%; max-height: 100%;" src="https://files-storage.easygenerator.com/image/36702979-d869-42fe-a5f0-8770f1458114.png" alt="" data-src="https://files-storage.easygenerator.com/image/ada6e3a8-97bb-4a2d-b8b9-9b0f071fd6da.png" data-init="{&quot;w&quot;:880,&quot;h&quot;:436.00000000000006,&quot;y&quot;:0,&quot;x&quot;:-38,&quot;defaultScale&quot;:2,&quot;scale&quot;:1}">
  </div>
  <div class="row" data-content-type="TextEditor"><p style="text-align:center;height:normal;">Figure 12.11: Using oledump tool to dump the content of suspicious macro streams</p><p style="text-align: justify;"><strong>Identifying Suspicious VBA Keywords &nbsp;</strong></p><p style="text-align:justify;height:normal;">You can now use the olevba tool to view the source codes of all VBA macros embedded within the document and identify suspicious VBA keywords and obfuscation methods used by the malware.</p><p style="text-align:justify;height:normal;">To use olevba, run the following command: <strong>olevba ‘&lt;path to the suspect document&gt;’</strong>.<em>&nbsp;</em>This will help them review the source codes of all VBA macros, detect if the document contains any auto-executable macros/obfuscated strings, and identify any indicators of compromise (IOCs), such as filenames, IP addresses, and URLs.</p><p style="text-align:justify;height:normal;">The screenshots below show the analysis of the <strong>infected_doc</strong> file by olevba, which shows that it contains auto-executable macros that have shellcode and strings obfuscated with Base64 and dridex.</p><p style="text-align:justify;height:normal;">Upon execution, these macros might download malicious files named test.exe and sfjozjero.exe from the internet and store them in the temp directory of the compromised system.</p><p style="text-align:justify;height:normal;">The following URLs are identified as IOCs:</p><ul><li style="text-align: justify;"><em>http://germanya.com.ec/logs/test.exe</em></li><li style="text-align: justify;"><em>http://germanya.com.ec/logs/counter.php</em></li></ul></div>
</div></div>