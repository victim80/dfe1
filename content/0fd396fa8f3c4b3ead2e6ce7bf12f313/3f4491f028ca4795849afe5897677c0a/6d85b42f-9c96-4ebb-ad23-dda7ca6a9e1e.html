<div class="eg-content-editor" data-type="imageEditorOneColumn"><div class="column">
  <div class="cropped-image" style="position:relative;overflow: hidden;padding-top: 56.25%">
    <img style="position: absolute; top: 50%;left: 50%;transform: translate(-50%, -50%);max-width: 100%; max-height: 100%;" src="https://files-storage.easygenerator.com/image/19459bfb-8087-4be4-9ba1-7217d371ed8b.png" alt="" data-src="https://files-storage.easygenerator.com/image/a793f5f4-55b2-4bd5-9863-7c8025346696.jpg" data-init="{&quot;w&quot;:880,&quot;h&quot;:495.00000000000006,&quot;y&quot;:0,&quot;x&quot;:0,&quot;defaultScale&quot;:1.375,&quot;scale&quot;:0.6875}">
  </div>
  <div class="row" data-content-type="TextEditor"><p style="text-align:justify;height:normal;">Investigators can use specific regular expressions to detect SQL injection attacks. To successfully examine an SQL injection attack, they must identify all kinds of meta-characters used in an SQL query, such as the semi-colon, double-dash, single-quote, and double minus sign, as well as their hex equivalents. &nbsp;Hence, it is necessary to evaluate these SQL-specific meta-characters while composing regular expressions. These regular expressions should be used to frame Snort signature rules and set SIEM alerts for the detection of SQL injection attacks.</p><p style="text-align:justify;height:normal;">The following regular expressions may be used to search for SQL-specific meta-characters and their hex equivalents:</p><p style="text-align: justify;"><strong>Regex for Detecting SQL Meta-Characters</strong></p><p style="text-align:justify;height:normal;"><strong>/(\%27)|(\')|(\-\-)|(\%23)|(#)/ix</strong></p><p style="text-align:justify;height:normal;">This signature searches for SQL meta-characters. It first searches either for the single quote ('), its hex equivalent, or the double-dash (--). It will not look for the hex equivalent of double-dash as it does not belong to HTML meta-character and cannot be encoded by the browser. &nbsp;In the case of MySQL databases, this signature also searches for the “#” character or its hex equivalent.</p><p style="text-align: justify;"><strong>Regex (Modified) for Detecting SQL Meta-Characters</strong></p><p style="text-align:justify;height:normal;"><strong>/((\%3D)|(=))[^\n]*((\%27)|(\')|(\-\-)|(\%3B)|(;))/i</strong></p><p style="text-align:justify;height:normal;">This signature searches for error-based SQL injection attempts. It first searches for the “=” character or its hex equivalent (%3D). Subsequently, it searches for zero or more non-newline characters, and finally, it searches for the single quote, double dash, or semicolon.</p><p style="text-align: justify;"><strong>Regex for Typical SQL Injection Attack</strong></p><p style="text-align:justify;height:normal;"><strong>/\w*((\%27)|(\'))((\%6F)|o|(\%4F))((\%72)|r|(\%52))/ix</strong></p><p style="text-align:justify;height:normal;">This signature searches for a string that begins with a constant alphanumeric value, followed by a single quote and then the word “or.” For example, it detects the string “1'or2&gt;1--.”.</p><p style="text-align:justify;height:normal;">The components of the above signature are explained below:</p><ul><li style="text-align: justify;"><strong>\w*:</strong> It searches for zero or more alphanumeric or underscore characters.</li><li style="text-align: justify;"><strong>(\%27)|\':</strong> It searches for the (‘) or single-quote character or its hex value.</li><li style="text-align: justify;"><strong>(\%6F)|o|(\%4F))((\%72)|r|(\%52):</strong> It searches for the word “or” with various combinations of its hex values (both upper-case and lower-case combinations).</li></ul><p style="text-align: justify;"><strong>Regex for Detecting SQL Injection with the UNION Keyword</strong></p><p style="text-align:justify;height:normal;"><strong>/((\%27)|(\'))union/ix</strong></p><p style="text-align:justify;height:normal;">This signature searches for a union-based SQL injection attempt where:</p><ul><li style="text-align: justify;"><strong>(\%27)|(\'):</strong> Searches for the single quote and its hex equivalent.</li><li style="text-align: justify;"><strong>union:</strong> Searches for the keyword “union”. Other SQL keywords, such as “select,” “insert,” “update,” and “delete,” can also be used in addition to “union”:</li><li style="text-align:justify;height:normal;"><strong><em>/((\%27)|(\'))(select|union|insert|update|delete|replace|truncate/drop)/ix</em></strong></li></ul><p style="text-align: justify;"><strong>Regex for Detecting SQL Injection Attacks on an MS SQL Server</strong></p><p style="text-align:justify;height:normal;"><strong>/exec(\s|\+)+(s|x)p\w+/ix</strong></p><p style="text-align:justify;height:normal;">This signature searches for an SQL injection attempt on a MS SQL server. Its components are explained below:</p><ul><li style="text-align: justify;">exec: Searches for the keyword for executing a stored or extended procedure.</li><li style="text-align: justify;"><strong>(\s|\+)+:</strong> Searches for whitespaces or their HTTP-encoded values.</li><li style="text-align: justify;"><strong>(s|x)p:</strong> Searches the letters “sp” or “xp” (representing stored or extended procedures, respectively).</li><li style="text-align: justify;"><strong>\w+:</strong> Searches for at least one alphanumeric or underscore character</li></ul></div>
</div></div>